---
title: "Communicating with Charts"
subtitle: "Data Visualisation Workshop"
author: "Nicola Rennie<br><small>1 November 2023</small>"
footer: "[nrennie.github.io/chicas-data-viz-workshop](https://nrennie.github.io/chicas-data-viz-workshop)"
format:
  LUstyle-revealjs:
    self-contained: true
execute: 
  eval: true
  echo: false
  warning: false
---

## Introduction

This session will include:

* why you should visualise data;

* some guidelines for making better charts;

* examples of charts made in R;

* a chance for you to make charts!

## RSS Data Visualisation Guide

[royal-statistical-society.github.io/datavisguide](https://royal-statistical-society.github.io/datavisguide/)

![](images/guide-screenshot.png){fig-align="center" fig-alt="Screenshot of data vis guide homepage" width="50%"}

```{r}
#| label: setup
library(ggplot2)
library(dplyr)
library(tidyr)
library(kableExtra)
library(RColorBrewer)
library(datasauRus)
theme_set(theme_grey(base_size = 32))
```

## Why visualise data?

::: columns
::: {.column width="50%"}
Data visualisation has two main purposes:

* Exploratory data analysis and identifying data issues
* Communicating insights and results

:::

::: {.column width="50%"}
![](images/data_viz_books.png){fig-align="center" fig-alt="Examples of sequential, diverging, and qualitative palettes" width="90%"}
:::
:::


## Exploratory data visualisation

Because summary statistics aren't enough...

::: columns
::: {.column width="50%"}

```{r}
dino_data <- datasaurus_dozen |> 
  filter(dataset %in% c("dino", "slant_up")) |>
  mutate(dataset = case_when(
    dataset == "dino" ~ "A",
    dataset == "slant_up" ~ "B"
  ))

dino_data |> 
  group_by(dataset) |> 
  summarise(mean_x = mean(x),
            mean_y = mean(y),
            sd_x = sd(x),
            sd_y = sd(y)) |> 
  pivot_longer(-1, names_to = "Dataset") %>%
  pivot_wider(names_from = 1, values_from = value) |> 
  kbl() |> 
  kable_styling("striped")
```

:::

::: {.column width="50%" .fragment .center}

```{r}
#| fig-width: 8
#| fig-height: 4
ggplot(data = dino_data,
       mapping = aes(x = x, y = y))+
  geom_point(size = 2) +
  facet_wrap(~dataset, ncol = 2) +
  theme_bw() +
  theme(legend.position = "none")
```

:::
:::

## Communicating insights with data visualisation

**Grab attention**

Visualisations stand out. If a reader is short on time or uncertain about whether a document is of interest, an attention-grabbing visualisation may entice them to start reading.

**Improve access to information**

Textual descriptions can be lengthy and hard to read, and are frequently less precise than a visual depiction showing data points and axes.

**Summarise content**

Visual displays allow for summarising complex textual content, aiding the reader in memorising key points.

## Communicating insights with data visualisation

::: columns
::: {.column width="60%"}

John Snow collected data on cholera deaths and created a visualisation where the number of deaths was represented by the height of a bar at the corresponding address in London.

This visualisation showed that the deaths clustered around Broad Street, which helped identify the cause of the cholera transmission, the Broad Street water pump.

Snow. 1854.

:::

::: {.column width="40%"}
![](images/Snow-cholera-map.jpg){fig-align="center" fig-alt="John Snow cholera map" width=100%}

:::

:::

# Tips for better charts {background-color="#D9DBDB"}

## Choosing a chart type

::: columns
::: {.column width="35%"}
What is the purpose of the chart?

Try: [ft-interactive.github.io/visual-vocabulary](https://ft-interactive.github.io/visual-vocabulary/)

:::

::: {.column width="65%"}
![](images/visual-vocabulary.png){fig-align="center" fig-alt="Screenshot of visual vocabulary website" width="100%"}
:::

:::

## Why do people hate pie charts?

![](images/hate.gif){fig-align="center" fig-alt="Taylor Swift hate gif" width=50%}

::: {.center}

<small>Source: <a href="https://giphy.com/gifs/taylor-swift-haters-gonna-hate-gon-LOWLRHs42LPUDtal3m">giphy.com</a></small>

:::

## Why do people hate pie charts?

::: columns

::: {.column}

```{r}
#| label: pie-uneven
#| fig-height: 7
#| fig-width: 7
par(mai = c(0, 0, 0, 0))
pie(x = c(11, 1), labels = LETTERS[1:2], col = brewer.pal(2, "Dark2"), cex = 2)
```

:::

::: {.column .fragment}

```{r}
#| label: pie-even
#| fig-height: 7
#| fig-width: 7
par(mai = c(0, 0, 0, 0))
pie(x = c(6.5, 5.5), labels = LETTERS[1:2], col = brewer.pal(2, "Dark2"), cex = 2)
```

:::

:::

## Why do people hate pie charts?

![](images/the-sun.jpg){fig-align="center" fig-alt="The Sun front page showing the Boris Johnson pie chart" width="65%"}

## Elements of charts

::: columns
::: {.column width="33%"}
-   Layout
-   Aspect ratio
-   Lines
-   Points
:::

::: {.column width="33%"}
-   Colours
-   Axes
-   Symbols
-   Legends
:::

::: {.column width="33%"}
-   Orientation
-   Auxiliary elements
-   Dimensionality
:::
:::

## Layouts

facet layout example

## Lines

::: columns
::: {.column width="50%"}
- Suggest an order
- Suggest continuity
:::

::: {.column width="50%"}
```{r}
#| label: lines
#| fig-height: 7
ggplot(data.frame(x = LETTERS[1:5], y = c(1, 4, 2, 5, 9)),
       aes(x = x, y = y)) +
  geom_col() +
  geom_line(aes(group = 1), linewidth = 1) +
  labs(subtitle = "(Don't do this!)")
```
:::
:::

## Colours

Why use colours in data visualisation?

-   Colours should serve a purpose, e.g. discerning groups of data

-   Colours can highlight or emphasise parts of your data.

-   Not always the most effective for, e.g. communicating differences between variables.

## Colours

::: columns

::: {.column}
Different types of colour palettes...

<br>

... for different types of data.
:::

::: {.column}
![](images/styling-palettes.png){fig-align="center" fig-alt="Examples of sequential, diverging, and qualitative palettes" width="90%"}
:::

:::


## Colours

Is this a good choice of colour?

```{r}
#| label: diamonds-bar
#| fig-width: 12
#| fig-align: center
g <- diamonds |> 
  mutate(cut = as.character(cut),
         cut = factor(cut, levels = c("Fair", "Good", "Very Good", "Premium", "Ideal"))) |> 
  ggplot() +
  geom_bar(aes(x = cut, fill = cut)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
g
```

## Colours

Check for colourblind friendly plots with `colorblindr::cvd_grid(g)`.

```{r}
#| label: cvd-grid
#| fig-width: 9
#| fig-align: center
theme_set(theme_grey(base_size = 10))
colorblindr::cvd_grid(g)
```

## Colours

::: columns
::: {.column width="50%"}
* In base R via {RColorBrewer}: `brewer.pal(4, "Dark2")`

* In {ggplot2}, `scale_fill_brewer()`, `scale_fill_distiller()`, `scale_colour_brewer()`, `scale_fcolour_distiller()`.
:::

::: {.column width="50%"}
![[colorbrewer2.org](https://colorbrewer2.org/#type=sequential&scheme=BuGn&n=3)](images/colorbrewer.png){fig-alt="Screenshot of colorbrewer2.org" width="100%"}
:::

:::


## Legends

```{r}
theme_set(theme_grey(base_size = 32))
```

-   Should not use up valuable space for data
-   May be integrated into the figure

## Fonts

## Key points

* Charts should have a purpose

## Useful resources

::: columns
::: {.column width="60%"}
* Fundamentals of data visualization: [clauswilke.com/dataviz](https://clauswilke.com/dataviz/)

* R Graphics Cookbook: [r-graphics.org](https://r-graphics.org/)

* #TidyTuesday: [github.com/rfordatascience/tidytuesday](https://github.com/rfordatascience/tidytuesday)

* DataWrapper Blog: [blog.datawrapper.de](https://blog.datawrapper.de/)
:::

::: {.column width="40%"}

![](images/tt.png){fig-alt="TidyTuesday logo" width="90%"}

:::

:::

## Good charts don't have to be boring!

::: columns
::: {.column .fragment}
![Cara Thompson (cararthompson.com)](https://raw.githubusercontent.com/cararthompson/tidytuesdays/main/plots/202209_lego.png){fig-alt="Stacked diverging bar chart of lego colours" width="98%"}
:::

::: {.column .fragment}
![Cedric Scherer (cedricscherer.com)](https://www.cedricscherer.com/img/gallery-tidytuesday//TidyTuesday_Week_2020_41_NCAA_Womens_Basketball.jpg){fig-alt="small multiples are charts of college basketball" width="90%"}
:::
:::

## Good charts don't have to be boring!

::: columns
::: {.column}
![Tanya Shapiro (tanyaviz.com)](https://tanyaviz.com/plots/scotus-justice-confirmations.png){fig-alt="Supreme court justice chart" width="100%"}
:::

::: {.column .fragment}
![Dan Oehm (gradientdescending.com)](https://raw.githubusercontent.com/doehm/tidytues/main/scripts/2023/week-23-energy/energy.png){fig-alt="Sloped area chart" width="100%"}
:::
:::

# Your turn! {background-color="#D9DBDB"}

## Exercise 1

In groups, discuss the following chart. How could you improve it?

::: columns

::: {.column}
![](images/economist1.png){fig-align="center" fig-alt="Bar chart from the economist" width=85%}
:::

::: {.column .fragment}
![](images/economist2.png){fig-align="center" fig-alt="Improved bar chart from the economist" width=85%}
:::

:::

::: {.fragment}

<small>Source: <a href="https://medium.economist.com/mistakes-weve-drawn-a-few-8cdd8a42d368">medium.economist.com/mistakes-weve-drawn-a-few-8cdd8a42d368</a></small>

:::

```{r}
#| label: ex-1-timer
countdown::countdown(minutes = 5,
                    color_border = "#b20e10",
                    color_text = "#b20e10",
                    color_running_text = "white",
                    color_running_background = "#b20e10",
                    color_finished_text = "#b20e10",
                    color_finished_background = "white",
                    top = 0,
                    margin = "1.2em",
                    font_size = "2em")
```

## Exercise 2

::: columns

::: {.column}
This data set is from a study published in 1757 in A Treatise on the Scurvy in Three Parts, by James Lind.

"*Pages 149-153 are a rare gem among what can be generously described as 400+ pages of evidence-free blathering, and these 4 pages may represent the first report of a controlled clinical trial.*"
:::

::: {.column .scrolling}

```{r}
#| label: scurvy-data
library(medicaldata)
data("scurvy")
kbl(scurvy) |> 
  kable_styling(bootstrap_options = c("striped"), fixed_thead = T)
```

:::

:::




## Exercise 2

Edit the code to improve this chart:

```{r}
#| label: ex-2
#| echo: true
#| output-location: column
#| fig-height: 5
library(ggplot2)
library(medicaldata)
data("scurvy")

ggplot(data = scurvy) +
  geom_col(mapping = aes(
    x = study_id,
    y = gum_rot_d6,
    fill = treatment
  )) +
  theme(legend.position = "bottom")
```


```{r}
#| label: ex-2-timer
countdown::countdown(minutes = 13,
                    color_border = "#b20e10",
                    color_text = "#b20e10",
                    color_running_text = "white",
                    color_running_background = "#b20e10",
                    color_finished_text = "#b20e10",
                    color_finished_background = "white",
                    top = 0,
                    margin = "1.2em",
                    font_size = "2em")
```

## Exercise 3

Bring your own chart! (Or make a new one!)

::: columns

::: {.column}
Data sources:

* `library(medicaldata)`

* #TidyTuesday: [github.com/rfordatascience/tidytuesday](https://github.com/rfordatascience/tidytuesday)

:::

::: {.column .center}

![](images/dog.gif){fig-align="center" fig-alt="Gif of labrador painting" width=60%}

<small>Source: <a href="https://giphy.com/gifs/dog-human-painting-4y6DqPvlICp5S">giphy.com</a></small>

:::

:::


## Workshop resources

::: columns

::: {.column}
GitHub: [github.com/nrennie/chicas-data-viz-workshop](https://github.com/nrennie/chicas-data-viz-workshop)

<br>

Slides: [nrennie.github.io/chicas-data-viz-workshop](https://nrennie.github.io/chicas-data-viz-workshop)
:::

::: {.column .center}

![](images/hate.gif){fig-align="center" fig-alt="Taylor Swift hate gif" width=60%}

<small>Source: <a href="https://giphy.com/gifs/taylor-swift-haters-gonna-hate-gon-LOWLRHs42LPUDtal3m">giphy.com</a></small>

:::

:::




